[{"path":"https://ausgis.github.io/sesp/articles/sesp.html","id":"install-and-load-r-packages","dir":"Articles","previous_headings":"","what":"Install and load R packages","title":"Spatially Explicit Stratified Power Model","text":"","code":"install.packages(c(\"sf\",\"gdverse\"), dep = T) # install.packages(\"devtools\") devtools::install_github(\"ausgis/sesp\",                          build_vignettes = TRUE,                          dep = TRUE) library(sf) ## Linking to GEOS 3.12.1, GDAL 3.8.4, PROJ 9.3.1; sf_use_s2() is TRUE library(sesp) library(gdverse)"},{"path":"https://ausgis.github.io/sesp/articles/sesp.html","id":"equivalence-of-q-values-in-the-native-geographical-detector-and-linear-regression-framework","dir":"Articles","previous_headings":"","what":"Equivalence of Q Values in the Native Geographical Detector and Linear Regression Framework","title":"Spatially Explicit Stratified Power Model","text":"","code":"NTDs = sf::st_as_sf(gdverse::NTDs, coords = c('X','Y'))  system.time({ go1 = sesp(incidence ~ ., data = NTDs, discvar = 'none',            model = 'ols', overlay = 'intersection') }) ##    user  system elapsed  ##    0.45    0.02    0.55  system.time({ go2 = gd(incidence ~ ., data = NTDs,          type = c('factor','interaction')) }) ##    user  system elapsed  ##    0.05    0.00    0.08"},{"path":"https://ausgis.github.io/sesp/articles/sesp.html","id":"factor-detector","dir":"Articles","previous_headings":"Equivalence of Q Values in the Native Geographical Detector and Linear Regression Framework","what":"Factor detector","title":"Spatially Explicit Stratified Power Model","text":"","code":"go1$factor ## # A tibble: 3 × 5 ##   Variable  Qvalue    AIC    BIC LogLik ##   <chr>      <dbl>  <dbl>  <dbl>  <dbl> ## 1 watershed  0.638 -10.0  -10.0   15.0  ## 2 elevation  0.607   1.18   1.18   7.41 ## 3 soiltype   0.386  79.7   79.7  -33.8 go2$factor ## # A tibble: 3 × 3 ##   variable  `Q-statistic` `P-value` ##   <chr>             <dbl>     <dbl> ## 1 watershed         0.638  0.000129 ## 2 elevation         0.607  0.0434   ## 3 soiltype          0.386  0.372"},{"path":"https://ausgis.github.io/sesp/articles/sesp.html","id":"interaction-detector","dir":"Articles","previous_headings":"Equivalence of Q Values in the Native Geographical Detector and Linear Regression Framework","what":"Interaction detector","title":"Spatially Explicit Stratified Power Model","text":"","code":"go1$interaction ## # A tibble: 3 × 5 ##   Variable              Interaction    Qv1   Qv2  Qv12 ##   <chr>                 <chr>        <dbl> <dbl> <dbl> ## 1 watershed ∩ elevation Enhance, bi- 0.638 0.607 0.714 ## 2 watershed ∩ soiltype  Enhance, bi- 0.638 0.386 0.736 ## 3 elevation ∩ soiltype  Enhance, bi- 0.607 0.386 0.664 go2$interaction ## # A tibble: 3 × 6 ##   variable1 variable2 Interaction  `Variable1 Q-statistics` `Variable2 Q-statistics` ##   <chr>     <chr>     <chr>                           <dbl>                    <dbl> ## 1 watershed elevation Enhance, bi-                    0.638                    0.607 ## 2 watershed soiltype  Enhance, bi-                    0.638                    0.386 ## 3 elevation soiltype  Enhance, bi-                    0.607                    0.386 ## # ℹ 1 more variable: `Variable1 and Variable2 interact Q-statistics` <dbl>"},{"path":"https://ausgis.github.io/sesp/articles/sesp.html","id":"spatially-explicit-stratified-power-model-under-the-spatial-linear-regression-framework","dir":"Articles","previous_headings":"","what":"Spatially Explicit Stratified Power Model Under The Spatial Linear Regression Framework","title":"Spatially Explicit Stratified Power Model","text":"Using data gdverse idsa vignette:","code":"depression = system.file('extdata/Depression.csv',package = 'gdverse') |>   readr::read_csv() |>   sf::st_as_sf(coords = c('X','Y'), crs = 4326) ## Rows: 1072 Columns: 13 ## ── Column specification ─────────────────────────────────────────────────────────────────────────── ## Delimiter: \",\" ## dbl (13): X, Y, Depression_prevelence, PopulationDensity, Population65, NoHealthInsurance, Neig... ##  ## ℹ Use `spec()` to retrieve the full column specification for this data. ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. depression ## Simple feature collection with 1072 features and 11 fields ## Geometry type: POINT ## Dimension:     XY ## Bounding box:  xmin: -83.1795 ymin: 32.11464 xmax: -78.6023 ymax: 35.17354 ## Geodetic CRS:  WGS 84 ## # A tibble: 1,072 × 12 ##    Depression_prevelence PopulationDensity Population65 NoHealthInsurance Neighbor_Disadvantage ##  *                 <dbl>             <dbl>        <dbl>             <dbl>                 <dbl> ##  1                  23.1              61.5         22.5              7.98               -0.0525 ##  2                  22.8              58.3         16.8             11.0                -0.254  ##  3                  23.2              35.9         24.5              9.31               -0.0540 ##  4                  21.8              76.1         21.8             13.2                 0.0731 ##  5                  20.7              47.3         22.0             11                   0.763  ##  6                  21.3              32.5         19.2             13.0                 0.422  ##  7                  22                36.9         19.2             10.8                 0.113  ##  8                  21.2              61.5         15.9              8.57               -0.154  ##  9                  22.7              67.2         15.7             17.8                -0.320  ## 10                  20.6             254.          11.3             12.7                 0.457  ## # ℹ 1,062 more rows ## # ℹ 7 more variables: Beer <dbl>, MentalHealthPati <dbl>, NatureParks <dbl>, Casinos <dbl>, ## #   DrinkingPlaces <dbl>, X.HouseRent <dbl>, geometry <POINT [°]>"},{"path":"https://ausgis.github.io/sesp/articles/sesp.html","id":"apply-natural-breaks-to-the-response-variable-to-generate-3-local-zones","dir":"Articles","previous_headings":"Spatially Explicit Stratified Power Model Under The Spatial Linear Regression Framework","what":"Apply natural breaks to the response variable to generate 3 local zones","title":"Spatially Explicit Stratified Power Model","text":"","code":"yzone = sdsfun::discretize_vector(depression$Depression_prevelence,3,method = 'natural') depressionmap = sf::st_sf(zones = yzone,geom = sf::st_geometry(depression))  ggplot2::ggplot(data = depressionmap) +     ggplot2::geom_sf(ggplot2::aes(color = factor(zones)), alpha = .65) +     ggplot2::labs(color = 'zones') +     ggplot2::theme_bw()"},{"path":"https://ausgis.github.io/sesp/articles/sesp.html","id":"spatially-explicit-stratified-power-model-with-linear-regression","dir":"Articles","previous_headings":"Spatially Explicit Stratified Power Model Under The Spatial Linear Regression Framework","what":"Spatially Explicit Stratified Power Model With Linear Regression","title":"Spatially Explicit Stratified Power Model","text":"","code":"system.time({   g1 = sesp(Depression_prevelence ~ ., data = depression, yzone = yzone,             model = 'ols', overlay = 'intersection', cores = 8) }) ##    user  system elapsed  ##    3.69    0.44   21.57 g1 ## ***          Spatially Explicit Stratified Power      ##  ##  Q values are estimated using *Ordinary Least Square*  ##  ##  -------------- Global Power of Determinat : ------------ ## Variable              Qvalue AIC      BIC      LogLik     ## PopulationDensity     0.278  4404.766 4404.766 -2193.383  ## Population65          0.201  4507.632 4507.632 -2247.816  ## NoHealthInsurance     0.214  4491.437 4491.437 -2238.719  ## Neighbor_Disadvantage 0.194  4516.820 4516.820 -2252.410  ## Beer                  0.192  4522.881 4522.881 -2253.441  ## MentalHealthPati      0.207  4498.614 4498.614 -2243.307  ## NatureParks           0.184  4529.323 4529.323 -2258.662  ## Casinos               0.184  4529.888 4529.888 -2258.944  ## DrinkingPlaces        0.204  4503.093 4503.093 -2245.547  ## X.HouseRent           0.259  4428.440 4428.440 -2207.220  ##  ##  ------------- Global Variable Interaction : ------------ ## Variable                                    Interaction   ## PopulationDensity ∩ Population65          Enhance, bi-  ## PopulationDensity ∩ NoHealthInsurance     Enhance, bi-  ## PopulationDensity ∩ Neighbor_Disadvantage Enhance, bi-  ## PopulationDensity ∩ Beer                  Enhance, bi-  ## PopulationDensity ∩ MentalHealthPati      Enhance, bi-  ## PopulationDensity ∩ NatureParks           Enhance, bi-  ## PopulationDensity ∩ Casinos               Enhance, bi-  ## PopulationDensity ∩ DrinkingPlaces        Enhance, bi-  ## PopulationDensity ∩ X.HouseRent           Enhance, bi-  ## Population65 ∩ NoHealthInsurance          Enhance, bi-  ##  ## ! Only the top ten items of global scale are displayed. ## ! The others can be accessed through specific subsets."},{"path":"https://ausgis.github.io/sesp/articles/sesp.html","id":"spatially-explicit-stratified-power-model-with-spatial-lag-regression","dir":"Articles","previous_headings":"Spatially Explicit Stratified Power Model Under The Spatial Linear Regression Framework","what":"Spatially Explicit Stratified Power Model With Spatial Lag Regression","title":"Spatially Explicit Stratified Power Model","text":"","code":"system.time({   g2 = sesp(Depression_prevelence ~ ., data = depression,             yzone = yzone, model = 'lag', cores = 8) }) ##    user  system elapsed  ##    7.25    1.01  256.97 g2 ## ***          Spatially Explicit Stratified Power      ##  ##  Q values are estimated using *Spatial Lag Model*  ##  ##  -------------- Global Power of Determinat : ------------ ## Variable              Qvalue AIC      BIC      LogLik     ## PopulationDensity     0.172  4315.505 4315.505 -2149.753  ## Population65          0.157  4336.429 4336.429 -2161.214  ## NoHealthInsurance     0.170  4325.982 4325.982 -2154.991  ## Neighbor_Disadvantage 0.153  4347.690 4347.690 -2166.845  ## Beer                  0.128  4356.675 4356.675 -2170.337  ## MentalHealthPati      0.161  4335.474 4335.474 -2160.737  ## NatureParks           0.147  4364.919 4364.919 -2175.460  ## Casinos               0.134  4351.252 4351.252 -2168.626  ## DrinkingPlaces        0.162  4330.582 4330.582 -2158.291  ## X.HouseRent           0.221  4286.168 4286.168 -2135.084  ##  ##  ------------- Global Variable Interaction : ------------ ## Variable                                    Interaction   ## PopulationDensity ∩ Population65          Enhance, bi-  ## PopulationDensity ∩ NoHealthInsurance     Enhance, bi-  ## PopulationDensity ∩ Neighbor_Disadvantage Enhance, bi-  ## PopulationDensity ∩ Beer                  Enhance, bi-  ## PopulationDensity ∩ MentalHealthPati      Weaken, uni-  ## PopulationDensity ∩ NatureParks           Enhance, bi-  ## PopulationDensity ∩ Casinos               Weaken, uni-  ## PopulationDensity ∩ DrinkingPlaces        Enhance, bi-  ## PopulationDensity ∩ X.HouseRent           Enhance, bi-  ## Population65 ∩ NoHealthInsurance          Enhance, bi-  ##  ## ! Only the top ten items of global scale are displayed. ## ! The others can be accessed through specific subsets."},{"path":"https://ausgis.github.io/sesp/articles/sesp.html","id":"spatially-explicit-stratified-power-model-with-spatial-error-regression","dir":"Articles","previous_headings":"Spatially Explicit Stratified Power Model Under The Spatial Linear Regression Framework","what":"Spatially Explicit Stratified Power Model With Spatial Error Regression","title":"Spatially Explicit Stratified Power Model","text":"","code":"system.time({   g3 = sesp(Depression_prevelence ~ ., data = depression,             yzone = yzone, model = 'error', cores = 8) }) ##    user  system elapsed  ##    7.43    0.92  137.33 g3 ## ***          Spatially Explicit Stratified Power      ##  ##  Q values are estimated using *Spatial Error Model*  ##  ##  -------------- Global Power of Determinat : ------------ ## Variable              Qvalue AIC      BIC      LogLik     ## PopulationDensity     0.260  4242.465 4242.465 -2111.232  ## Population65          0.195  4294.715 4294.715 -2140.358  ## NoHealthInsurance     0.208  4283.546 4283.546 -2133.773  ## Neighbor_Disadvantage 0.188  4309.098 4309.098 -2147.549  ## Beer                  0.180  4302.506 4302.506 -2142.253  ## MentalHealthPati      0.197  4293.660 4293.660 -2139.830  ## NatureParks           0.176  4330.177 4330.177 -2158.089  ## Casinos               0.173  4304.348 4304.348 -2145.174  ## DrinkingPlaces        0.195  4294.383 4294.383 -2140.192  ## X.HouseRent           0.253  4243.816 4243.816 -2113.908  ##  ##  ------------- Global Variable Interaction : ------------ ## Variable                                    Interaction   ## PopulationDensity ∩ Population65          Enhance, bi-  ## PopulationDensity ∩ NoHealthInsurance     Enhance, bi-  ## PopulationDensity ∩ Neighbor_Disadvantage Enhance, bi-  ## PopulationDensity ∩ Beer                  Enhance, bi-  ## PopulationDensity ∩ MentalHealthPati      Enhance, bi-  ## PopulationDensity ∩ NatureParks           Enhance, bi-  ## PopulationDensity ∩ Casinos               Enhance, bi-  ## PopulationDensity ∩ DrinkingPlaces        Enhance, bi-  ## PopulationDensity ∩ X.HouseRent           Enhance, bi-  ## Population65 ∩ NoHealthInsurance          Enhance, bi-  ##  ## ! Only the top ten items of global scale are displayed. ## ! The others can be accessed through specific subsets."},{"path":"https://ausgis.github.io/sesp/articles/sesp.html","id":"spatially-explicit-stratified-power-model-with-spatial-durbin-regression","dir":"Articles","previous_headings":"Spatially Explicit Stratified Power Model Under The Spatial Linear Regression Framework","what":"Spatially Explicit Stratified Power Model With Spatial Durbin Regression","title":"Spatially Explicit Stratified Power Model","text":"","code":"system.time({   g4 = sesp(Depression_prevelence ~ ., data = depression, yzone = yzone,             model = 'lag', durbin = TRUE, cores = 8) }) ##    user  system elapsed  ##    8.20    1.30  257.54 g4 ## ***          Spatially Explicit Stratified Power      ##  ##  Q values are estimated using *Spatial Durbin Model*  ##  ##  -------------- Global Power of Determinat : ------------ ## Variable              Qvalue AIC      BIC      LogLik     ## PopulationDensity     0.241  4258.246 4258.246 -2116.123  ## Population65          0.212  4293.682 4293.682 -2135.841  ## NoHealthInsurance     0.226  4284.655 4284.655 -2129.328  ## Neighbor_Disadvantage 0.203  4309.408 4309.408 -2143.704  ## Beer                  0.238  4283.330 4283.330 -2124.665  ## MentalHealthPati      0.302  4251.558 4251.558 -2110.779  ## NatureParks           0.245  4295.636 4295.636 -2130.818  ## Casinos               0.226  4295.287 4295.287 -2132.643  ## DrinkingPlaces        0.218  4287.728 4287.728 -2132.864  ## X.HouseRent           0.274  4243.204 4243.204 -2108.602  ##  ##  ------------- Global Variable Interaction : ------------ ## Variable                                    Interaction   ## PopulationDensity ∩ Population65          Enhance, bi-  ## PopulationDensity ∩ NoHealthInsurance     Enhance, bi-  ## PopulationDensity ∩ Neighbor_Disadvantage Enhance, bi-  ## PopulationDensity ∩ Beer                  Enhance, bi-  ## PopulationDensity ∩ MentalHealthPati      Enhance, bi-  ## PopulationDensity ∩ NatureParks           Enhance, bi-  ## PopulationDensity ∩ Casinos               Enhance, bi-  ## PopulationDensity ∩ DrinkingPlaces        Enhance, bi-  ## PopulationDensity ∩ X.HouseRent           Enhance, bi-  ## Population65 ∩ NoHealthInsurance          Enhance, bi-  ##  ## ! Only the top ten items of global scale are displayed. ## ! The others can be accessed through specific subsets."},{"path":"https://ausgis.github.io/sesp/articles/sesp.html","id":"spatially-explicit-stratified-power-model-with-geographically-weighted-regression","dir":"Articles","previous_headings":"Spatially Explicit Stratified Power Model Under The Spatial Linear Regression Framework","what":"Spatially Explicit Stratified Power Model With Geographically Weighted Regression","title":"Spatially Explicit Stratified Power Model","text":"","code":"system.time({   g5 = sesp(Depression_prevelence ~ ., data = depression,             yzone = yzone, model = 'gwr', cores = 8) }) ##    user  system elapsed  ##    8.75    1.00  136.28 g5 ## ***          Spatially Explicit Stratified Power      ##  ##  Q values are estimated using *Geographically Weighted Regression*  ##  ##  -------------- Global Power of Determinat : ------------ ## Variable              Qvalue AIC       ## PopulationDensity     0.255  4428.172  ## Population65          0.355  4278.376  ## NoHealthInsurance     0.250  4435.042  ## Neighbor_Disadvantage 0.363  4263.032  ## Beer                  0.267  4411.036  ## MentalHealthPati      0.357  4273.905  ## NatureParks           0.270  4407.348  ## Casinos               0.339  4305.724  ## DrinkingPlaces        0.274  4401.081  ## X.HouseRent           0.295  4370.236  ##  ##  ------------- Global Variable Interaction : ------------ ## Variable                                    Interaction   ## PopulationDensity ∩ Population65          Weaken, uni-  ## PopulationDensity ∩ NoHealthInsurance     Enhance, bi-  ## PopulationDensity ∩ Neighbor_Disadvantage Enhance, bi-  ## PopulationDensity ∩ Beer                  Enhance, bi-  ## PopulationDensity ∩ MentalHealthPati      Weaken, uni-  ## PopulationDensity ∩ NatureParks           Enhance, bi-  ## PopulationDensity ∩ Casinos               Weaken, uni-  ## PopulationDensity ∩ DrinkingPlaces        Weaken, uni-  ## PopulationDensity ∩ X.HouseRent           Enhance, bi-  ## Population65 ∩ NoHealthInsurance          Weaken, uni-  ##  ## ! Only the top ten items of global scale are displayed. ## ! The others can be accessed through specific subsets."},{"path":"https://ausgis.github.io/sesp/articles/sesp.html","id":"results-of-local-zones-based-power-of-determinat","dir":"Articles","previous_headings":"Spatially Explicit Stratified Power Model Under The Spatial Linear Regression Framework","what":"Results of local zones-based power of determinat","title":"Spatially Explicit Stratified Power Model","text":"","code":"g1$localq ## # A tibble: 30 × 6 ##    Variable              Qvalue   AIC   BIC LogLik  Zone ##    <chr>                  <dbl> <dbl> <dbl>  <dbl> <int> ##  1 PopulationDensity     0.141   666.  666.  -324.     3 ##  2 Population65          0.0673  677.  677.  -333.     3 ##  3 NoHealthInsurance     0.0545  680.  680.  -334.     3 ##  4 Neighbor_Disadvantage 0.0830  674.  674.  -331.     3 ##  5 Beer                  0.0613  683.  683.  -333.     3 ##  6 MentalHealthPati      0.0500  681.  681.  -335.     3 ##  7 NatureParks           0.0611  679.  679.  -333.     3 ##  8 Casinos               0.0490  682.  682.  -335.     3 ##  9 DrinkingPlaces        0.0522  681.  681.  -334.     3 ## 10 X.HouseRent           0.0590  681.  681.  -334.     3 ## # ℹ 20 more rows g2$localq ## # A tibble: 30 × 6 ##    Variable              Qvalue   AIC   BIC LogLik  Zone ##    <chr>                  <dbl> <dbl> <dbl>  <dbl> <int> ##  1 PopulationDensity     0.0791  679.  679.  -331.     3 ##  2 Population65          0.0713  679.  679.  -332.     3 ##  3 NoHealthInsurance     0.0597  681.  681.  -334.     3 ##  4 Neighbor_Disadvantage 0.0863  675.  675.  -331.     3 ##  5 Beer                  0.0537  684.  684.  -334.     3 ##  6 MentalHealthPati      0.0545  682.  682.  -334.     3 ##  7 NatureParks           0.0657  680.  680.  -333.     3 ##  8 Casinos               0.0532  682.  682.  -334.     3 ##  9 DrinkingPlaces        0.0570  682.  682.  -334.     3 ## 10 X.HouseRent           0.0640  682.  682.  -333.     3 ## # ℹ 20 more rows g3$localq ## # A tibble: 30 × 6 ##    Variable              Qvalue   AIC   BIC LogLik  Zone ##    <chr>                  <dbl> <dbl> <dbl>  <dbl> <int> ##  1 PopulationDensity     0.141   667.  667.  -323.     3 ##  2 Population65          0.0673  679.  679.  -333.     3 ##  3 NoHealthInsurance     0.0543  682.  682.  -334.     3 ##  4 Neighbor_Disadvantage 0.0830  676.  676.  -331.     3 ##  5 Beer                  0.0611  684.  684.  -333.     3 ##  6 MentalHealthPati      0.0498  683.  683.  -334.     3 ##  7 NatureParks           0.0611  681.  681.  -333.     3 ##  8 Casinos               0.0488  683.  683.  -334.     3 ##  9 DrinkingPlaces        0.0520  683.  683.  -334.     3 ## 10 X.HouseRent           0.0589  683.  683.  -334.     3 ## # ℹ 20 more rows g4$localq ## # A tibble: 30 × 6 ##    Variable              Qvalue   AIC   BIC LogLik  Zone ##    <chr>                  <dbl> <dbl> <dbl>  <dbl> <int> ##  1 PopulationDensity      0.133  676.  676.  -325.     3 ##  2 Population65           0.109  677.  677.  -328.     3 ##  3 NoHealthInsurance      0.118  675.  675.  -327.     3 ##  4 Neighbor_Disadvantage  0.114  676.  676.  -327.     3 ##  5 Beer                   0.138  682.  682.  -324.     3 ##  6 MentalHealthPati       0.106  686.  686.  -328.     3 ##  7 NatureParks            0.182  670.  670.  -318.     3 ##  8 Casinos                0.108  686.  686.  -328.     3 ##  9 DrinkingPlaces         0.102  679.  679.  -329.     3 ## 10 X.HouseRent            0.128  677.  677.  -325.     3 ## # ℹ 20 more rows g5$localq ## # A tibble: 30 × 4 ##    Variable              Qvalue   AIC  Zone ##    <chr>                  <dbl> <dbl> <int> ##  1 PopulationDensity     0.106   664.     3 ##  2 Population65          0.162   652.     3 ##  3 NoHealthInsurance     0.0662  672.     3 ##  4 Neighbor_Disadvantage 0.131   658.     3 ##  5 Beer                  0.0619  673.     3 ##  6 MentalHealthPati      0.150   658.     3 ##  7 NatureParks           0.0815  669.     3 ##  8 Casinos               0.138   659.     3 ##  9 DrinkingPlaces        0.0849  668.     3 ## 10 X.HouseRent           0.133   660.     3 ## # ℹ 20 more rows"},{"path":"https://ausgis.github.io/sesp/articles/sesp.html","id":"results-of-optimal-spatial-discretization","dir":"Articles","previous_headings":"Spatially Explicit Stratified Power Model Under The Spatial Linear Regression Framework","what":"Results of optimal spatial discretization","title":"Spatially Explicit Stratified Power Model","text":"","code":"plot_optdisc = \\(g){  gmap = sf::st_set_geometry(g$optdisc,sf::st_geometry(depression))   fig1 = seq_along(g$optdisc) |>    purrr::map(\\(.x) ggplot2::ggplot(data = gmap) +                 ggplot2::geom_sf(ggplot2::aes(color = factor(g$optdisc[,.x,drop = TRUE])),                                  alpha = .65) +                 ggplot2::labs(color = 'zones') +                 ggplot2::theme_void() +                 ggplot2::theme(                   legend.position = \"none\")                 ) %>%    patchwork::wrap_plots(ncol = 3, byrow = TRUE) +    patchwork::plot_annotation(      tag_levels = 'a',      tag_prefix = '(',      tag_suffix = ')',      tag_sep = '',      theme = ggplot2::theme(plot.tag = ggplot2::element_text(family = \"serif\"),                             plot.tag.position = \"topleft\"))  return(fig1) } plot_optdisc(g1) plot_optdisc(g2) plot_optdisc(g3) plot_optdisc(g4) plot_optdisc(g5)"},{"path":"https://ausgis.github.io/sesp/articles/whysed.html","id":"install-necessary-r-packages","dir":"Articles","previous_headings":"","what":"Install Necessary R Packages","title":"Why Is Spatially Explicit Discretization Necessary?","text":"","code":"install.packages(c(\"sf\",\"terra\",\"sdsfun\",\"gdverse\"),dep = TRUE) # install.packages(\"devtools\") devtools::install_github(\"ausgis/sesp\",build_vignettes = TRUE,dep = TRUE) # install.packages(\"pak\") pak::pak(\"josiahparry/spdgp\")"},{"path":"https://ausgis.github.io/sesp/articles/whysed.html","id":"simulated-independent-strata-x","dir":"Articles","previous_headings":"","what":"Simulated Independent Strata X","title":"Why Is Spatially Explicit Discretization Necessary?","text":"","code":"m = matrix(2,nrow = 15, ncol = 15) zone1_indice = c(6:9,seq(8,by = -1,length.out = 6)) for (i in seq_along(zone1_indice)) {   m[seq(1,zone1_indice[i]),i] = 1 } m[,11:15] = 3 m[13,11] = 2 m[14,11:12] = 2 m[15,11:13] = 2  library(sf) library(terra) r = terra::rast(m, crs = \"EPSG:4326\") names(r) = 'simx_strata' simx = sf::st_as_sf(terra::as.points(r)) simx ## Simple feature collection with 225 features and 1 field ## Geometry type: POINT ## Dimension:     XY ## Bounding box:  xmin: 0.5 ymin: 0.5 xmax: 14.5 ymax: 14.5 ## Geodetic CRS:  WGS 84 ## First 10 features: ##    simx_strata         geometry ## 1            1 POINT (0.5 14.5) ## 2            1 POINT (1.5 14.5) ## 3            1 POINT (2.5 14.5) ## 4            1 POINT (3.5 14.5) ## 5            1 POINT (4.5 14.5) ## 6            1 POINT (5.5 14.5) ## 7            1 POINT (6.5 14.5) ## 8            1 POINT (7.5 14.5) ## 9            1 POINT (8.5 14.5) ## 10           1 POINT (9.5 14.5)  strata1 = tibble::tibble(   x = c(0,0,3.5,10,10),   y = c(15,9.5,6,12.5,15) ) |>   sf::st_as_sf(coords = c(\"x\",\"y\"), crs = 4326) |>   sf::st_combine() |>   sf::st_cast(\"POLYGON\")  strata2 = tibble::tibble(   x = c(0,0,3.5,10,10,13.5),   y = c(0,9.5,6,12.5,3.5,0) ) |>   sf::st_as_sf(coords = c(\"x\",\"y\"), crs = 4326) |>   sf::st_combine() |>   sf::st_cast(\"POLYGON\")  strata3 = tibble::tibble(   x = c(15,15,10,10,13.5),   y = c(0,15,15,3.5,0) ) |>   sf::st_as_sf(coords = c(\"x\",\"y\"), crs = 4326) |>   sf::st_combine() |>   sf::st_cast(\"POLYGON\")  strata = sf::st_sf(stratas = c(1,2,3),                    geometry = do.call(c, list(strata1,strata2,strata3)))  ggplot2::ggplot() +   ggplot2::geom_sf(data = strata, fill = 'transparent',                    color = 'grey10', lwd = 0.75) +   ggplot2::geom_sf(data = simx,                    ggplot2::aes(color = factor(simx_strata))) +   ggplot2::labs(color = 'Strata') +   ggplot2::theme_void()"},{"path":"https://ausgis.github.io/sesp/articles/whysed.html","id":"a-monte-carlo-simulation-experiment-demonstrating-the-necessity-of-spatial-explicit-discretization","dir":"Articles","previous_headings":"","what":"A Monte Carlo simulation experiment demonstrating the necessity of spatial explicit discretization","title":"Why Is Spatially Explicit Discretization Necessary?","text":"error term specified \\(\\mu \\sim \\mathcal{N}(0, 0.1)\\), corresponding \\(Y\\) simulated using spatial durbin process. autoregressive coefficients X set twice stratification levels, .e., stratifications 1, 2, 3 correspond autoregressive coefficients 2, 4, 6, respectively. spatial lag coefficient takes values 0.05 0.95 interval 0.05. spatial lag coefficient \\(\\rho\\), randomly simulate 100 times.","code":"us = vector(\"list\",100) for (i in seq_along(us)) {   us[[i]] = rnorm(nrow(simx),0,0.1) }  rho = seq(0.05,0.95,by = 0.05)  lw = spdep::nb2listw(sdsfun::spdep_nb(simx),                      style = \"W\",                      zero.policy = TRUE) mc_simq = \\(cores = 6){   doclust = FALSE   if (inherits(cores, \"cluster\")) {     doclust = TRUE   } else if (cores > 1) {     doclust = TRUE     cores = parallel::makeCluster(cores)     on.exit(parallel::stopCluster(cores), add = TRUE)   }    paradf = tidyr::crossing(\"rho\" = rho,                            \"ui\" = 1:100)   parak = split(paradf, seq_len(nrow(paradf)))    gdist = stats::as.dist(sdsfun::sf_distance_matrix(simx))   hclustgeo_disc = \\(xv,alpha = 0.5){     D0 = stats::dist(xv)     resh = ClustGeo::hclustgeo(D0,gdist,alpha = alpha)     return(stats::cutree(resh,3))   }    calcul_q = \\(paramgd){     rhov = paramgd[[1]]     u_i = paramgd[[2]]     y = spdgp::sim_durbin(us[[u_i]], simx$simx_strata*2, simx$simx_strata, lw, rho = rhov)     sed = hclustgeo_disc(y,alpha = 0.75)     sid = hclustgeo_disc(y,alpha = 0)     qv1 = gdverse::factor_detector(y,sed)[[1]]     qv2 = gdverse::factor_detector(y,sid)[[1]]     res = tibble::tibble(qv_sed = qv1, qv_sid = qv2,                          qv_bias = qv1 - qv2,rho = rhov)     return(res)   }    if (doclust) {     parallel::clusterExport(cores, varlist = c(\"simx\",\"us\",\"rho\",\"lw\"))     out_g = parallel::parLapply(cores,parak,calcul_q)     out_g = tibble::as_tibble(do.call(rbind, out_g))   } else {     out_g = purrr::map_dfr(parak,calcul_q)   }   return(out_g) }  qv = mc_simq(cores = 12) qv ## # A tibble: 1,900 × 4 ##    qv_sed qv_sid qv_bias   rho ##     <dbl>  <dbl>   <dbl> <dbl> ##  1  0.998  0.998       0  0.05 ##  2  0.998  0.998       0  0.05 ##  3  0.997  0.997       0  0.05 ##  4  0.998  0.998       0  0.05 ##  5  0.998  0.998       0  0.05 ##  6  0.998  0.998       0  0.05 ##  7  0.998  0.998       0  0.05 ##  8  0.998  0.998       0  0.05 ##  9  0.998  0.998       0  0.05 ## 10  0.998  0.998       0  0.05 ## # ℹ 1,890 more rows tapply(qv$qv_bias, qv$rho, mean) ##         0.05          0.1         0.15          0.2         0.25          0.3         0.35  ## -0.003730299 -0.004598168 -0.008629568 -0.009083803 -0.013027071 -0.020524905 -0.034507171  ##          0.4         0.45          0.5         0.55          0.6         0.65          0.7  ## -0.036417126 -0.035733490 -0.042590039 -0.050666891 -0.069836797 -0.093104122 -0.095702926  ##         0.75          0.8         0.85          0.9         0.95  ## -0.111785462 -0.130288998 -0.171257233 -0.228723769 -0.237107745"},{"path":"https://ausgis.github.io/sesp/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Wenbo Lv. Author, maintainer, copyright holder. Wufan Zhao. Author. Yongze Song. Author. Shaoqing Dai. Author.","code":""},{"path":"https://ausgis.github.io/sesp/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Lv W, Zhao W, Song Y, Dai S (2024). sesp: Spatially Explicit Stratified Power. R package version 1.0, https://github.com/ausgis/sesp, https://ausgis.github.io/sesp/.","code":"@Manual{,   title = {sesp: Spatially Explicit Stratified Power},   author = {Wenbo Lv and Wufan Zhao and Yongze Song and Shaoqing Dai},   year = {2024},   note = {R package version 1.0, https://github.com/ausgis/sesp},   url = {https://ausgis.github.io/sesp/}, }"},{"path":"https://ausgis.github.io/sesp/index.html","id":"sesp-","dir":"","previous_headings":"","what":"sesp | Spatially Explicit Stratified Power\n","title":"sesp | Spatially Explicit Stratified Power\n","text":"Spatially Explicit Stratified Power Model","code":""},{"path":"https://ausgis.github.io/sesp/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"sesp | Spatially Explicit Stratified Power\n","text":"Install development source version GitHub :","code":"if (!requireNamespace(\"devtools\")) {     install.packages(\"devtools\") } devtools::install_github(\"ausgis/sesp\",                          build_vignettes = TRUE,                          dep = TRUE)"},{"path":"https://ausgis.github.io/sesp/reference/fuzzyoverlay2.html","id":null,"dir":"Reference","previous_headings":"","what":"Spatial fuzzy overlay between variables pairwise — fuzzyoverlay2","title":"Spatial fuzzy overlay between variables pairwise — fuzzyoverlay2","text":"Spatial fuzzy overlay variables pairwise","code":""},{"path":"https://ausgis.github.io/sesp/reference/fuzzyoverlay2.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spatial fuzzy overlay between variables pairwise — fuzzyoverlay2","text":"","code":"fuzzyoverlay2(formula, data, method = \"and\")"},{"path":"https://ausgis.github.io/sesp/reference/fuzzyoverlay2.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Spatial fuzzy overlay between variables pairwise — fuzzyoverlay2","text":"formula formula. data data.frame tibble discretized data. method (optional) Spatial overlay method. One , , intersection. Default .","code":""},{"path":"https://ausgis.github.io/sesp/reference/fuzzyoverlay2.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Spatial fuzzy overlay between variables pairwise — fuzzyoverlay2","text":"list overlay overlay results pairs variables variable pairwise interacting variable","code":""},{"path":"https://ausgis.github.io/sesp/reference/fuzzyoverlay2.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Spatial fuzzy overlay between variables pairwise — fuzzyoverlay2","text":"","code":"sim = tibble::tibble(y = stats::runif(7,0,10),                      x1 = c(1,rep(2,3),rep(3,3)),                      x2 = c(rep(1,2),rep(2,2),rep(3,3)),                      x3 = c(rep(1,3),rep(2,2),rep(3,2))) fo1 = fuzzyoverlay2(y ~ .,data = sim, method = 'and') fo1 #> $overlay #> # A tibble: 7 × 3 #>     xi1   xi2   xi3 #>   <int> <int> <int> #> 1     1     1     1 #> 2     3     3     1 #> 3     4     3     2 #> 4     4     4     4 #> 5     2     4     4 #> 6     2     2     3 #> 7     2     2     3 #>  #> $variable #> [1] \"x1 ∩ x2\" \"x1 ∩ x3\" \"x2 ∩ x3\" #>  fo2 = fuzzyoverlay2(y ~ .,data = sim, method = 'or') fo2 #> $overlay #> # A tibble: 7 × 3 #>     xi1   xi2   xi3 #>   <int> <int> <int> #> 1     3     3     3 #> 2     1     1     3 #> 3     1     1     3 #> 4     1     1     1 #> 5     2     2     2 #> 6     2     4     4 #> 7     2     4     4 #>  #> $variable #> [1] \"x1 ∩ x2\" \"x1 ∩ x3\" \"x2 ∩ x3\" #>  fo3 = fuzzyoverlay2(y ~ .,data = sim, method = 'intersection') fo3 #> $overlay #> # A tibble: 7 × 3 #>     xi1   xi2   xi3 #>   <int> <int> <int> #> 1     1     1     1 #> 2     2     2     1 #> 3     3     2     2 #> 4     3     3     3 #> 5     4     4     4 #> 6     4     5     5 #> 7     4     5     5 #>  #> $variable #> [1] \"x1 ∩ x2\" \"x1 ∩ x3\" \"x2 ∩ x3\" #>"},{"path":"https://ausgis.github.io/sesp/reference/gwr_betas.html","id":null,"dir":"Reference","previous_headings":"","what":"Estimate gwr model coefficients — gwr_betas","title":"Estimate gwr model coefficients — gwr_betas","text":"Estimate gwr model coefficients","code":""},{"path":"https://ausgis.github.io/sesp/reference/gwr_betas.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Estimate gwr model coefficients — gwr_betas","text":"","code":"gwr_betas(   formula,   data,   bw = \"AIC\",   adaptive = TRUE,   kernel = \"gaussian\",   intercept = FALSE )"},{"path":"https://ausgis.github.io/sesp/reference/gwr_betas.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Estimate gwr model coefficients — gwr_betas","text":"formula formula gwr model. data sf object observation data bw (optional) bandwidth used selecting models. optimal bandwidth can selected using one two methods: AIC, CV. Default use AIC. adaptive (optional) Whether bandwidth value adaptive . Default TRUE. kernel (optional) Kernel function. Default gaussian. intercept (optional) Whether include intercept term coefficient tibble. Default FALSE`.","code":""},{"path":"https://ausgis.github.io/sesp/reference/gwr_betas.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Estimate gwr model coefficients — gwr_betas","text":"tibble","code":""},{"path":"https://ausgis.github.io/sesp/reference/gwr_betas.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Estimate gwr model coefficients — gwr_betas","text":"","code":"# \\donttest{ depression = system.file('extdata/Depression.csv',package = 'gdverse') |>   readr::read_csv() |>   sf::st_as_sf(coords = c('X','Y'), crs = 4326) #> Rows: 1072 Columns: 13 #> ── Column specification ──────────────────────────────────────────────────────── #> Delimiter: \",\" #> dbl (13): X, Y, Depression_prevelence, PopulationDensity, Population65, NoHe... #>  #> ℹ Use `spec()` to retrieve the full column specification for this data. #> ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message. gwr_betas(Depression_prevelence ~ ., data = depression) #> # A tibble: 1,072 × 10 #>    PopulationDensity Population65 NoHealthInsurance Neighbor_Disadvantage #>                <dbl>        <dbl>             <dbl>                 <dbl> #>  1         -0.00117       -0.0746            0.0681                 0.493 #>  2         -0.00123       -0.0861            0.0826                 0.546 #>  3         -0.00124       -0.0963            0.0999                 0.816 #>  4         -0.00120       -0.102             0.0882                 0.334 #>  5         -0.00116       -0.105             0.0931                 0.271 #>  6         -0.00121       -0.103             0.0919                 0.611 #>  7         -0.000301      -0.122             0.0801                 0.248 #>  8         -0.000261      -0.104             0.113                  0.394 #>  9         -0.000608      -0.0873            0.133                  0.851 #> 10         -0.000668      -0.0831            0.139                  0.812 #> # ℹ 1,062 more rows #> # ℹ 6 more variables: Beer <dbl>, MentalHealthPati <dbl>, NatureParks <dbl>, #> #   Casinos <dbl>, DrinkingPlaces <dbl>, X.HouseRent <dbl> gwr_betas(Depression_prevelence ~ ., data = depression, intercept = TRUE) #> # A tibble: 1,072 × 11 #>    Intercept PopulationDensity Population65 NoHealthInsurance #>        <dbl>             <dbl>        <dbl>             <dbl> #>  1      24.0         -0.00117       -0.0746            0.0681 #>  2      23.7         -0.00123       -0.0861            0.0826 #>  3      23.4         -0.00124       -0.0963            0.0999 #>  4      23.7         -0.00120       -0.102             0.0882 #>  5      23.4         -0.00116       -0.105             0.0931 #>  6      23.4         -0.00121       -0.103             0.0919 #>  7      22.6         -0.000301      -0.122             0.0801 #>  8      22.0         -0.000261      -0.104             0.113  #>  9      20.5         -0.000608      -0.0873            0.133  #> 10      20.6         -0.000668      -0.0831            0.139  #> # ℹ 1,062 more rows #> # ℹ 7 more variables: Neighbor_Disadvantage <dbl>, Beer <dbl>, #> #   MentalHealthPati <dbl>, NatureParks <dbl>, Casinos <dbl>, #> #   DrinkingPlaces <dbl>, X.HouseRent <dbl> # }"},{"path":"https://ausgis.github.io/sesp/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://ausgis.github.io/sesp/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://ausgis.github.io/sesp/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"NULL (magrittr pipe operator)","code":""},{"path":"https://ausgis.github.io/sesp/reference/sesp.html","id":null,"dir":"Reference","previous_headings":"","what":"Spatially Explicit Stratified Power (SESP) Model — sesp","title":"Spatially Explicit Stratified Power (SESP) Model — sesp","text":"Equivalent geographical detector \\(q\\)-values spatial linear regression framework.","code":""},{"path":"https://ausgis.github.io/sesp/reference/sesp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Spatially Explicit Stratified Power (SESP) Model — sesp","text":"","code":"sesp(   formula,   data,   listw = NULL,   yzone = NULL,   discvar = \"all\",   discnum = 3:8,   model = \"ols\",   durbin = FALSE,   overlay = \"and\",   alpha = 0.75,   bw = \"AIC\",   adaptive = TRUE,   kernel = \"gaussian\",   increase_rate = 0.05,   cores = 1,   ... )"},{"path":"https://ausgis.github.io/sesp/reference/sesp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Spatially Explicit Stratified Power (SESP) Model — sesp","text":"formula formula enhanced stratified power model. data sf object observation data. Please note column names independent variables none. listw (optional) list listw. See spdep::mat2listw() spdep::nb2listw() details. yzone (optional) Spatial zones response variable. yzone NULL, local zones q value calculated. Default NULL. discvar (optional) Name continuous variable columns need discretized. Noted formula discvar, data must columns. Default , means independent variables used discvar. discvar set none, independent variables need discretized. discnum (optional) Number discretization. Default use 3:8. model (optional) type linear model used, default ols. model value must ols, gwr, lag error. durbin (optional) Whether consider spatial durbin terms, default false. overlay (optional) Spatial overlay method. One , , intersection. Default . alpha (optional) Controlling strength spatial soft constraints, larger alpha, stronger spatial soft constraint. Default 0.75. bw (optional) bandwidth used selecting models. optimal bandwidth can selected using one two methods: AIC, CV. Default AIC. adaptive (optional) Whether bandwidth value adaptive . Default TRUE. kernel (optional) Kernel function. Default gaussian. increase_rate (optional) critical increase rate number discretization. Default 5%. cores (optional) Positive integer (default 1). cores greater 1, use multi-core parallel computing. ... (optional) arguments passed ClustGeo::hclustgeo().","code":""},{"path":"https://ausgis.github.io/sesp/reference/sesp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Spatially Explicit Stratified Power (SESP) Model — sesp","text":"list. factor global factor detection result interaction global interactive detection results optdisc independent variable optimal spatial discretization localq q values explanatory variables different response zones zone zones response variable allfactor factor detection results corresponding different numbers discreteization model regression model used estimate equivalent q values","code":""},{"path":"https://ausgis.github.io/sesp/reference/sesp.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Spatially Explicit Stratified Power (SESP) Model — sesp","text":"","code":"NTDs = sf::st_as_sf(gdverse::NTDs, coords = c('X','Y')) g = sesp(incidence ~ ., data = NTDs, discvar = 'none',          model = 'ols', overlay = 'intersection', cores = 1) g #> ***          Spatially Explicit Stratified Power      #>  #>  Q values are estimated using *Ordinary Least Square*  #>  #>  -------------- Global Power of Determinat : ------------ #> Variable  Qvalue AIC     BIC     LogLik   #> watershed 0.638  -10.039 -10.039 15.020   #> elevation 0.607  1.183   1.183   7.409    #> soiltype  0.386  79.675  79.675  -33.838  #>  #>  ------------- Global Variable Interaction : ------------ #> Variable                Interaction   #> watershed ∩ elevation Enhance, bi-  #> watershed ∩ soiltype  Enhance, bi-  #> elevation ∩ soiltype  Enhance, bi-  #>  #> ! Only the top ten items of global scale are displayed. #> ! The others can be accessed through specific subsets."},{"path":"https://ausgis.github.io/sesp/news/index.html","id":"sesp-10","dir":"Changelog","previous_headings":"","what":"sesp 1.0","title":"sesp 1.0","text":"First stable release.","code":""}]
